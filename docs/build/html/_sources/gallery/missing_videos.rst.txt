
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "gallery/missing_videos.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_gallery_missing_videos.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_gallery_missing_videos.py:


Missing Videos
==============

Statistics related to missing question videos

.. GENERATED FROM PYTHON SOURCE LINES 7-58




.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    SSH tunnel established on local port 5433
    SSH tunnel stopped
    1550
    2216
    41.15772703133298






|

.. code-block:: Python


    import polars as pl

    import src

    query = """SELECT data, "explanationId"
    FROM public."Resource" 
    WHERE "type" = 'VIDEO'
    """

    dfr = src.exec_postgres_query(query)

    dfr = dfr.with_columns(yt_link=pl.col("data").struct[0]).drop("data")
    dfq = src.load_tables("question")
    dfe = src.load_tables("explanation")
    dfc = src.load_tables("course")

    dfq = (
        dfq.join(dfe, left_on="id", right_on="questionId")
        .join(dfr, left_on="id_right", right_on="explanationId", how="left")
        .join(dfc, left_on="courseId", right_on="id")
        .with_columns(
            course_name=pl.col("abbreviation") + " " + pl.col("number_right").cast(str)
        )
    )

    dfq = (
        dfq.group_by("course_name")
        .agg(
            pl.col("yt_link").count().alias("question_videos"),
            pl.col("yt_link").is_null().sum().alias("missing_question_videos"),
            pl.col("id").count().alias("total_questions"),
        )
        .sort("missing_question_videos")
    )

    dfq = dfq.with_columns(
        (100 * pl.col("missing_question_videos") / pl.col("total_questions")).alias(
            "missing_percent"
        )
    )

    total_missing_question_videos = dfq["missing_question_videos"].sum()
    total_videos = dfq["question_videos"].sum()
    total_questions = dfq["total_questions"].sum()
    print(total_missing_question_videos)
    print(total_videos)
    print(total_missing_question_videos / total_questions * 100)

    pl.Config().set_tbl_rows(100)
    # print(dfq)


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 0.874 seconds)


.. _sphx_glr_download_gallery_missing_videos.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: missing_videos.ipynb <missing_videos.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: missing_videos.py <missing_videos.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: missing_videos.zip <missing_videos.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
