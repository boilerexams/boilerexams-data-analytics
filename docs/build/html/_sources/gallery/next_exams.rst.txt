
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "gallery/next_exams.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_gallery_next_exams.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_gallery_next_exams.py:


Next Week's Exams
=================

Prints information for the next week of exams

.. GENERATED FROM PYTHON SOURCE LINES 7-38




.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    shape: (4, 3)
    ┌─────────────┬─────────────┬─────────────────────────┐
    │ course_name ┆ day_of_week ┆ start                   │
    │ ---         ┆ ---         ┆ ---                     │
    │ str         ┆ str         ┆ datetime[μs, EST]       │
    ╞═════════════╪═════════════╪═════════════════════════╡
    │ CS 25100    ┆ Thursday    ┆ 2024-10-09 19:00:00 EST │
    │ STAT 35000  ┆ Thursday    ┆ 2024-10-10 17:30:00 EST │
    │ MA 30300    ┆ Thursday    ┆ 2024-10-10 17:30:00 EST │
    │ MA 16100    ┆ Friday      ┆ 2024-10-10 19:00:00 EST │
    └─────────────┴─────────────┴─────────────────────────┘






|

.. code-block:: Python


    import datetime

    import polars as pl

    import src

    dfc = src.load_tables("course").select("id", "number", "abbreviation")
    dfe = (
        src.load_tables("event")
        .select("start", "end", "courseId")
        .join(dfc, left_on="courseId", right_on="id")
        .drop("courseId")
        .with_columns(pl.col("start").dt.replace_time_zone("UTC"))
        .with_columns(
            course_name=pl.col("abbreviation") + " " + pl.col("number").cast(str),
            day_of_week=pl.col("start").dt.to_string("%A"),
        )
    )

    today = datetime.datetime.now(tz=datetime.timezone.utc)
    horizon = datetime.timedelta(days=7)

    dfe = dfe.select("course_name", "day_of_week", "start")

    print(
        dfe.filter(pl.col("start") > today, pl.col("start") < today + horizon)
        .unique("course_name")
        .sort("start")
        .with_columns(start=pl.col("start").dt.convert_time_zone("EST"))
    )


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 0.002 seconds)


.. _sphx_glr_download_gallery_next_exams.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: next_exams.ipynb <next_exams.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: next_exams.py <next_exams.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: next_exams.zip <next_exams.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
